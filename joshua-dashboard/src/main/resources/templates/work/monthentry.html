<!DOCTYPE html>
<html lang="ja"
  xmlns="http://www.w3.org/1999/xhtml"
  xmlns:th="http://www.thymeleaf.org"
  xmlns:sec="https://www.thymeleaf.org/thymeleaf-extras-springsecurity5"
  xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
  layout:decorate="~{common/layout}">
<head>
<title>当月勤怠登録</title>
<script th:inline="javascript">
$(function() {
  /*<![CDATA[*/
  let regularMt = /*[[ ${regularMt} ]]*/;
  let beginHour = regularMt.beginHour;
  let beginMinute = regularMt.beginMinute;
  let endHour = regularMt.endHour;
  let endMinute = regularMt.endMinute;
  /*]]>*/
  $.each($("div.applyRegularMt"), function(i, val) {
    $(val).children("input").on("click", function() {
        $("input[name='dailyEntryFormList[" + i + "].workBeginHour']").val(beginHour);
        $("input[name='dailyEntryFormList[" + i + "].workBeginMinute']").val(beginMinute);
        $("input[name='dailyEntryFormList[" + i + "].workEndHour']").val(endHour);
        $("input[name='dailyEntryFormList[" + i + "].workEndMinute']").val(endMinute);
        console.log($("input[name='dailyEntryFormList[" + i + "].workBeginHour']").val());
      });
  });
  console.log(regularMt);
});
</script>
</head>
<body>
  <div layout:fragment="content">
    <br>
    <div class="container border col-10">
      <br>
      <h2>当月勤怠登録</h2>
      <div class="row">
        <div class="col-lg">
          <form th:action="@{/work/month/entry}" method="get">
            <table class="table table-borderless">
              <tr class="form-group zero-margin">
                <td>YYYYのセレクトリスト</td>
                <td>MMのセレクトリスト</td>
                <td><input type="submit" class="btn btn-outline-primary mt-1" value="反映" /></td>
              </tr>
            </table>
          </form>
          <form th:action="@{/work/month/entry}" method="post" th:object="${monthEntryForm}" novalidate>
            <table class="table table-borderless">
              <tr class="form-group zero-margin">
                <td>
                  <input type="submit" class="btn btn-outline-primary mt-1" value="登録" />
                </td>
              </tr>
              <tr class="form-group zero-margin">
                <th th:text=#{day}></th>
                <th th:text=#{weekDay}></th>
                <th th:text=#{beginWork}></th>
                <th th:text=#{endWork}></th>
                <th th:text=#{regular}></th>
                <th th:text=#{workStatus}></th>
              </tr>
              <tr th:each="mt, status : ${thisMonthList}">
                <td>
                  <div th:text="${#temporals.format(mt.date, 'd')}"></div>
                  <input type="hidden" th:name="${'dailyEntryFormList[' + status.index + '].date'}" th:value="${mt.date}" />
                </td>
                <td>
                  <div th:if="${mt.weekday == '1'}" th:text="#{sunday}" class="sunday"></div>
                  <div th:if="${mt.weekday == '2'}" th:text="#{monday}"></div>
                  <div th:if="${mt.weekday == '3'}" th:text="#{tuesday}"></div>
                  <div th:if="${mt.weekday == '4'}" th:text="#{wednesday}"></div>
                  <div th:if="${mt.weekday == '5'}" th:text="#{thursday}"></div>
                  <div th:if="${mt.weekday == '6'}" th:text="#{friday}"></div>
                  <div th:if="${mt.weekday == '7'}" th:text="#{saturday}" class="saturday"></div>
                </td>
                <td>
                  <div th:if="${mt.begin == null || mt.status == null}" class="row">
                    <input type="number" name="beginHour" class="form-control date-input" th:value="${#temporals.format(mt.begin, 'HH')}" th:name="${'dailyEntryFormList[' + status.index + '].workBeginHour'}" />
                    &nbsp;:&nbsp;
                    <input type="number" name="beginMinute" class="form-control date-input" th:value="${#temporals.format(mt.begin, 'mm')}" th:name="${'dailyEntryFormList[' + status.index + '].workBeginMinute'}" />
                  </div>
                  <div th:if="${mt.begin != null && mt.status == '1'}" th:text="${#temporals.format(mt.begin, 'HH:mm')}"></div>
                </td>
                <td>
                  <div th:if="${mt.end == null || mt.status == null}" class="row">
                    <input type="number" name="endHour" class="form-control date-input" th:value="${#temporals.format(mt.end, 'HH')}" th:name="${'dailyEntryFormList[' + status.index + '].workEndHour'}" />
                    &nbsp;:&nbsp;
                    <input type="number" name="endMinute" class="form-control date-input" th:value="${#temporals.format(mt.end, 'mm')}" th:name="${'dailyEntryFormList[' + status.index + '].workEndMinute'}" />
                  </div>
                  <div th:if="${mt.end != null && mt.status == '1'}" th:text="${#temporals.format(mt.end, 'HH:mm')}"></div>
                </td>
                <td>
                  <div class="applyRegularMt">
                    <input type="button" th:id="${'applyRegularMt[' + status.index + ']'}" class="btn btn-outline-info mt-1" value="反映" />
                  </div>
                </td>
                <td th:text="${mt.status}"></td>
              </tr>
              <tr>
                <td>
                  <input type="submit" class="btn btn-outline-primary mt-1" value="登録" />
                </td>
              </tr>
            </table>
          </form>
        </div><!-- /.col-lg -->
      </div><!-- /.row -->
    </div><!-- container border col-10 -->
    <br>
    <br>
    <br>
  </div>
</body>
</html>